PATH_add bin

use_chruby()
{
  local version
  version="${1}"

  [[ -z "${version}" ]] && return

  local chruby

  if has brew; then
    local brew_prefix
    brew_prefix="$(brew --prefix)"

    if [[ -e "${brew_prefix}/opt/chruby/share/chruby/chruby.sh" ]]; then
      chruby="${brew_prefix}/opt/chruby/share/chruby/chruby.sh"
    fi
  fi

  [[ -z "${chruby}" ]] && [[ -e /usr/local/share/chruby/chruby.sh ]] &&
    chruby=/usr/local/share/chruby/chruby.sh

  [[ -z "${chruby}" ]] && return

  source "${chruby}"
  RUBIES+=(/usr/lib)
  chruby "${version}"
}

use chruby 2.6.3

layout ruby

export EXPO_ROOT_DIR=`pwd`
export ANDROID_HOME=$ANDROID_SDK
export NIX_PATH=expo=`pwd`/nix:$NIX_PATH

source_local() {
  file=./.envrc.local
  if [[ -f "$file" ]]; then
    source_env "$file"
  fi
  watch_file "$file"
}

source_secrets() {
  file=$1
  if [[ -f "$file" ]] && head -1 "$file" | grep --quiet "#!"; then
    source_env "$file"
  fi
  watch_file "$file"
}

source_secrets secrets/expotools.env
source_local
